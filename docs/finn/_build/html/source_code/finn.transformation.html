

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Transformation &mdash; FINN  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transformation - FPGADataFlow" href="finn.transformation.fpgadataflow.html" />
    <link rel="prev" title="Custom Op - FPGADataFlow" href="finn.custom_op.fpgadataflow.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> FINN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../end_to_end_flow.html">FINN - End-to-End Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finn_internals.html">FINN - Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy_integration.html">Deployment and Integration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="finn.html">FINN - Source Code</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="finn.html#modules">Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="finn.analysis.html">Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="finn.core.html">Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="finn.custom_op.html">Custom Op</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Transformation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#guide-to-writing-finn-transformations">Guide to writing FINN transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transformation-passes">Transformation Passes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finn.util.html">Util</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FINN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="finn.html">FINN - Source Code</a> &raquo;</li>
        
      <li>Transformation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source_code/finn.transformation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-finn.transformation">
<span id="transformation"></span><h1>Transformation<a class="headerlink" href="#module-finn.transformation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="guide-to-writing-finn-transformations">
<h2>Guide to writing FINN transformations<a class="headerlink" href="#guide-to-writing-finn-transformations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Your transformation must inherit the Transformation abstract base class.</p></li>
<li><p>Your transformation’s apply function should take in a ModelWrapper, and return
a tuple with (transformed_model: ModelWrapper, model_was_changed: Bool)</p></li>
<li><p>The transformations are meant to be applied using the .transform function
in ModelWrapper. This makes a deep copy of the input model by default, so
you don’t have to.</p></li>
<li><p>model_was_changed indicates whether your transformation made any changes to
the model. If you know your transformation needs to be called only once and
repeated calls have no further effect, you can return False even if the model
was changed.</p></li>
<li><p>You MUST return model_was_changed=False at some point when your transformation
is called multiple times, otherwise apply_repeated() will loop infinitely.</p></li>
<li><p>If you cannot guarantee that the transformation will reach a fixed point,
you must declare this, return model_was_changed = False and let the user
manually re-apply the transform.</p></li>
</ul>
<dl class="class">
<dt id="finn.transformation.Transformation">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.</code><code class="sig-name descname">Transformation</code><a class="headerlink" href="#finn.transformation.Transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Transformation class all transformations are based on. Contains only 
abstract method apply() every transformation has to fill.</p>
<dl class="method">
<dt id="finn.transformation.Transformation.apply">
<em class="property">abstract </em><code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.Transformation.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="finn.transformation.fpgadataflow.html">Transformation - FPGADataFlow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="finn.transformation.fpgadataflow.html#transformations-fpgadataflow">Transformations (FPGADataFlow)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="finn.transformation.streamline.html">Transformation - Streamline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="finn.transformation.streamline.html#module-finn.transformation.streamline">Transformation (Streamline)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="transformation-passes">
<h2>Transformation Passes<a class="headerlink" href="#transformation-passes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-finn.transformation.batchnorm_to_affine">
<span id="finn-transformation-batchnorm-to-affine"></span><h3>finn.transformation.batchnorm_to_affine<a class="headerlink" href="#module-finn.transformation.batchnorm_to_affine" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.batchnorm_to_affine.BatchNormToAffine">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.batchnorm_to_affine.</code><code class="sig-name descname">BatchNormToAffine</code><a class="headerlink" href="#finn.transformation.batchnorm_to_affine.BatchNormToAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Replaces any test-time BatchNorm layers with Mul-Add layers.</p>
<dl class="method">
<dt id="finn.transformation.batchnorm_to_affine.BatchNormToAffine.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.batchnorm_to_affine.BatchNormToAffine.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-finn.transformation.bipolar_to_xnor">
<span id="finn-transformation-bipolar-to-xnor"></span><h3>finn.transformation.bipolar_to_xnor<a class="headerlink" href="#module-finn.transformation.bipolar_to_xnor" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.bipolar_to_xnor.ConvertBipolarMatMulToXnorPopcount">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.bipolar_to_xnor.</code><code class="sig-name descname">ConvertBipolarMatMulToXnorPopcount</code><a class="headerlink" href="#finn.transformation.bipolar_to_xnor.ConvertBipolarMatMulToXnorPopcount" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Convert MatMul nodes with all-bipolar inputs to XnorPopcountMatMul
and associated result correction.</p>
<dl class="method">
<dt id="finn.transformation.bipolar_to_xnor.ConvertBipolarMatMulToXnorPopcount.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.bipolar_to_xnor.ConvertBipolarMatMulToXnorPopcount.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-finn.transformation.fold_constants">
<span id="finn-transformation-fold-constants"></span><h3>finn.transformation.fold_constants<a class="headerlink" href="#module-finn.transformation.fold_constants" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.fold_constants.FoldConstants">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.fold_constants.</code><code class="sig-name descname">FoldConstants</code><a class="headerlink" href="#finn.transformation.fold_constants.FoldConstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Replace the output of a node with const-only inputs with a precomputed
result.</p>
<dl class="method">
<dt id="finn.transformation.fold_constants.FoldConstants.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.fold_constants.FoldConstants.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-finn.transformation.general">
<span id="finn-transformation-general"></span><h3>finn.transformation.general<a class="headerlink" href="#module-finn.transformation.general" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.general.ConvertSubToAdd">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.general.</code><code class="sig-name descname">ConvertSubToAdd</code><a class="headerlink" href="#finn.transformation.general.ConvertSubToAdd" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Convert sub nodes to add nodes of appropriate sign.</p>
<dl class="method">
<dt id="finn.transformation.general.ConvertSubToAdd.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.general.ConvertSubToAdd.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="finn.transformation.general.GiveRandomTensorNames">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.general.</code><code class="sig-name descname">GiveRandomTensorNames</code><a class="headerlink" href="#finn.transformation.general.GiveRandomTensorNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Give random tensor names to all tensors.</p>
<dl class="method">
<dt id="finn.transformation.general.GiveRandomTensorNames.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.general.GiveRandomTensorNames.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="finn.transformation.general.GiveReadableTensorNames">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.general.</code><code class="sig-name descname">GiveReadableTensorNames</code><a class="headerlink" href="#finn.transformation.general.GiveReadableTensorNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Give more human-readable names to all internal tensors. It’s recommended
to apply give_unique_node_names prior to this transform.</p>
<dl class="method">
<dt id="finn.transformation.general.GiveReadableTensorNames.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.general.GiveReadableTensorNames.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="finn.transformation.general.GiveUniqueNodeNames">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.general.</code><code class="sig-name descname">GiveUniqueNodeNames</code><a class="headerlink" href="#finn.transformation.general.GiveUniqueNodeNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Give unique names to each node in the graph using enumeration.</p>
<dl class="method">
<dt id="finn.transformation.general.GiveUniqueNodeNames.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.general.GiveUniqueNodeNames.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-finn.transformation.infer_datatypes">
<span id="finn-transformation-infer-datatypes"></span><h3>finn.transformation.infer_datatypes<a class="headerlink" href="#module-finn.transformation.infer_datatypes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.infer_datatypes.InferDataTypes">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.infer_datatypes.</code><code class="sig-name descname">InferDataTypes</code><a class="headerlink" href="#finn.transformation.infer_datatypes.InferDataTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Infer FINN DataType info for all intermediate/output tensors based on
inputs and node type.</p>
<dl class="method">
<dt id="finn.transformation.infer_datatypes.InferDataTypes.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.infer_datatypes.InferDataTypes.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-finn.transformation.infer_shapes">
<span id="finn-transformation-infer-shapes"></span><h3>finn.transformation.infer_shapes<a class="headerlink" href="#module-finn.transformation.infer_shapes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="finn.transformation.infer_shapes.InferShapes">
<em class="property">class </em><code class="sig-prename descclassname">finn.transformation.infer_shapes.</code><code class="sig-name descname">InferShapes</code><a class="headerlink" href="#finn.transformation.infer_shapes.InferShapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#finn.transformation.Transformation" title="finn.transformation.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">finn.transformation.Transformation</span></code></a></p>
<p>Ensure every tensor in the model has a specified shape (ValueInfo).</p>
<dl class="method">
<dt id="finn.transformation.infer_shapes.InferShapes.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">model</em><span class="sig-paren">)</span><a class="headerlink" href="#finn.transformation.infer_shapes.InferShapes.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="finn.transformation.fpgadataflow.html" class="btn btn-neutral float-right" title="Transformation - FPGADataFlow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="finn.custom_op.fpgadataflow.html" class="btn btn-neutral float-left" title="Custom Op - FPGADataFlow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Y. Umuroglu and J. Petri-Koenig

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>